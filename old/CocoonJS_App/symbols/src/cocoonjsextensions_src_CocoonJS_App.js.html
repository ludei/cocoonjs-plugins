<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>  2</span> </span><span class="WHIT">    </span><span class="COMM">// The CocoonJS must exist before creating the extension.</span><span class="WHIT">
<span class='line'>  3</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">window.CocoonJS</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">window.CocoonJS</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="PUNC">(</span><span class="STRN">"The CocoonJS object must exist and be valid before creating any extension object."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  4</span> 
<span class='line'>  5</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>  6</span>      * This namespace represents all the basic functionalities available in the CocoonJS extension API.
<span class='line'>  7</span>      * @namespace
<span class='line'>  8</span>      */</span><span class="WHIT">
<span class='line'>  9</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">CocoonJS.App</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">CocoonJS.App</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 10</span> 
<span class='line'> 11</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">CocoonJS.nativeExtensionObjectAvailable</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">window.ext.IDTK_APP</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 12</span> 
<span class='line'> 13</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'> 14</span>      * The predefined possible layouts for the FPS overlay.
<span class='line'> 15</span>      * @namespace
<span class='line'> 16</span>      * @enum
<span class='line'> 17</span>      */</span><span class="WHIT">
<span class='line'> 18</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.FPSLayout</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 19</span> </span><span class="WHIT">        </span><span class="NAME">TOP_LEFT</span><span class="PUNC">:</span><span class="STRN">'top-left'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 20</span> </span><span class="WHIT">        </span><span class="NAME">TOP_RIGHT</span><span class="PUNC">:</span><span class="STRN">'top-right'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 21</span> </span><span class="WHIT">        </span><span class="NAME">BOTTOM_LEFT</span><span class="PUNC">:</span><span class="STRN">'bottom-left'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 22</span> </span><span class="WHIT">        </span><span class="NAME">BOTTOM_RIGHT</span><span class="PUNC">:</span><span class="STRN">'bottom-right'</span><span class="WHIT">
<span class='line'> 23</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 24</span> 
<span class='line'> 25</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'> 26</span>     * The predefined possible orientations. there can be a bit level combination of them using the OR operator.
<span class='line'> 27</span>     * @namespace
<span class='line'> 28</span>     * @enum
<span class='line'> 29</span>     */</span><span class="WHIT">
<span class='line'> 30</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.Orientations</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 31</span> </span><span class="WHIT">        </span><span class="NAME">PORTRAIT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 32</span> </span><span class="WHIT">        </span><span class="NAME">PORTRAIT_UPSIDE_DOWN</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 33</span> </span><span class="WHIT">        </span><span class="NAME">LANDSCAPE_LEFT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 34</span> </span><span class="WHIT">        </span><span class="NAME">LANDSCAPE_RIGHT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">8</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 35</span> </span><span class="WHIT">        </span><span class="NAME">PORTRAIT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">|</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 36</span> </span><span class="WHIT">        </span><span class="NAME">LANDSCAPE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="WHIT"> </span><span class="PUNC">|</span><span class="WHIT"> </span><span class="NUMB">8</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 37</span> </span><span class="WHIT">        </span><span class="NAME">BOTH</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">|</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">|</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="WHIT"> </span><span class="PUNC">|</span><span class="WHIT"> </span><span class="NUMB">8</span><span class="WHIT">
<span class='line'> 38</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 39</span> 
<span class='line'> 40</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'> 41</span>      * Contains all the possible values to specify the input keyboard type to be used when introducing text.
<span class='line'> 42</span>      * @namespace
<span class='line'> 43</span>      * @enum
<span class='line'> 44</span>      */</span><span class="WHIT">
<span class='line'> 45</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.KeyboardType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 46</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'> 47</span>          * Represents a generic text input keyboard.
<span class='line'> 48</span>          */</span><span class="WHIT">
<span class='line'> 49</span> </span><span class="WHIT">        </span><span class="NAME">TEXT</span><span class="PUNC">:</span><span class="STRN">"text"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 50</span> 
<span class='line'> 51</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'> 52</span>          * Represents a number like input keyboard.
<span class='line'> 53</span>          */</span><span class="WHIT">
<span class='line'> 54</span> </span><span class="WHIT">        </span><span class="NAME">NUMBER</span><span class="PUNC">:</span><span class="STRN">"num"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 55</span> 
<span class='line'> 56</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'> 57</span>          * Represents a phone like input keyboard.
<span class='line'> 58</span>          */</span><span class="WHIT">
<span class='line'> 59</span> </span><span class="WHIT">        </span><span class="NAME">PHONE</span><span class="PUNC">:</span><span class="STRN">"phone"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 60</span> 
<span class='line'> 61</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'> 62</span>          * Represents an email like input keyboard.
<span class='line'> 63</span>          */</span><span class="WHIT">
<span class='line'> 64</span> </span><span class="WHIT">        </span><span class="NAME">EMAIL</span><span class="PUNC">:</span><span class="STRN">"email"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 65</span> 
<span class='line'> 66</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'> 67</span>          * Represents an URL like input keyboard.
<span class='line'> 68</span>          */</span><span class="WHIT">
<span class='line'> 69</span> </span><span class="WHIT">        </span><span class="NAME">URL</span><span class="PUNC">:</span><span class="STRN">"url"</span><span class="WHIT">
<span class='line'> 70</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 71</span> 
<span class='line'> 72</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'> 73</span>      * The storage types to be used with file system related operations.
<span class='line'> 74</span>      * @namespace
<span class='line'> 75</span>      * @enum
<span class='line'> 76</span>      */</span><span class="WHIT">
<span class='line'> 77</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.StorageType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 78</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'> 79</span>          * Represents the application storage. The application storage is the place where all the resources that come with the application are stored.
<span class='line'> 80</span>          */</span><span class="WHIT">
<span class='line'> 81</span> </span><span class="WHIT">        </span><span class="NAME">APP_STORAGE</span><span class="PUNC">:</span><span class="STRN">"APP_STORAGE"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 82</span> 
<span class='line'> 83</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'> 84</span>          * Represents the internal storage. The internal storage is a different storage space that the application storage and only the data that the application has stored
<span class='line'> 85</span>          * in it will be in this storage. It is internal to the platform/device.
<span class='line'> 86</span>          */</span><span class="WHIT">
<span class='line'> 87</span> </span><span class="WHIT">        </span><span class="NAME">INTERNAL_STORAGE</span><span class="PUNC">:</span><span class="STRN">"INTERNAL_STORAGE"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 88</span> 
<span class='line'> 89</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'> 90</span>          * Represents an external storage. The external storage is similar to the internal storage in the sense that it only contains information that the application has written
<span class='line'> 91</span>          * in it but it represents an external storage device like a SD-CARD. If there is no exrernal storage, it will represent the same as the internal storage.
<span class='line'> 92</span>          */</span><span class="WHIT">
<span class='line'> 93</span> </span><span class="WHIT">        </span><span class="NAME">EXTERNAL_STORAGE</span><span class="PUNC">:</span><span class="STRN">"EXTERNAL_STORAGE"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 94</span> 
<span class='line'> 95</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'> 96</span>          * Represents the temporal storage. Same as the internal and external storage spaces in the sense that it only contains information that the application has written
<span class='line'> 97</span>          * in it but the main difference is that the information in this storage may dissapear without notice.
<span class='line'> 98</span>          */</span><span class="WHIT">
<span class='line'> 99</span> </span><span class="WHIT">        </span><span class="NAME">TEMPORARY_STORAGE</span><span class="PUNC">:</span><span class="STRN">"TEMPORARY_STORAGE"</span><span class="WHIT">
<span class='line'>100</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>101</span> 
<span class='line'>102</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>103</span>      * The capture types to capture screenshots using CocoonJS native capabilities.
<span class='line'>104</span>      * @namespace
<span class='line'>105</span>      * @enum
<span class='line'>106</span>      */</span><span class="WHIT">
<span class='line'>107</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.CaptureType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>108</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'>109</span>          Captures everything, both the CocoonJS GL hardware accelerated surface and the system views (like the WebView).
<span class='line'>110</span>          */</span><span class="WHIT">
<span class='line'>111</span> </span><span class="WHIT">        </span><span class="NAME">EVERYTHING</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>112</span> 
<span class='line'>113</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'>114</span>          * Captures just the CocoonJS GL hardware accelerated surface.
<span class='line'>115</span>          */</span><span class="WHIT">
<span class='line'>116</span> </span><span class="WHIT">        </span><span class="NAME">JUST_COCOONJS_GL_SURFACE</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>117</span> 
<span class='line'>118</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'>119</span>          * Captures just the sustem views (like the webview)
<span class='line'>120</span>          */</span><span class="WHIT">
<span class='line'>121</span> </span><span class="WHIT">        </span><span class="NAME">JUST_SYSTEM_VIEWS</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="WHIT">
<span class='line'>122</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>123</span> 
<span class='line'>124</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>125</span>      * @ignore
<span class='line'>126</span>      * Forward service might not be available if only one JS service is included
<span class='line'>127</span>      */</span><span class="WHIT">
<span class='line'>128</span> </span><span class="WHIT">    </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">isNativeBridgeServiceAvailable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>129</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.forward.nativeAvailable</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'boolean'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>130</span> </span><span class="WHIT">            </span><span class="COMM">//cached value</span><span class="WHIT">
<span class='line'>131</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">CocoonJS.App.forward.nativeAvailable</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>132</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>133</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>134</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">available</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">CocoonJS.makeNativeExtensionObjectFunctionCall</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"forwardAvailable"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>135</span> </span><span class="WHIT">            </span><span class="NAME">available</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">available</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>136</span> </span><span class="WHIT">            </span><span class="NAME">CocoonJS.App.forward.nativeAvailable</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">available</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>137</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">available</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>138</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>139</span> 
<span class='line'>140</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>141</span> 
<span class='line'>142</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>143</span>      * Makes a forward call of some javascript code to be executed in a different environment (i.e. from CocoonJS to the WebView and viceversa).
<span class='line'>144</span>      * It waits until the code is executed and the result of it is returned === synchronous.
<span class='line'>145</span>      * @function
<span class='line'>146</span>      * @param {string} javaScriptCode Some JavaScript code in a string to be forwarded and executed in a different JavaScript environment (i.e. from CocoonJS to the WebView and viceversa).
<span class='line'>147</span>      * @return {string} The result of the execution of the passed JavaScript code in the different JavaScript environment.
<span class='line'>148</span>      */</span><span class="WHIT">
<span class='line'>149</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.forward</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">javaScriptCode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>150</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">isNativeBridgeServiceAvailable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>151</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">CocoonJS.makeNativeExtensionObjectFunctionCall</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"forward"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>152</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>153</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>154</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">window.name</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'CocoonJS_App_ForCocoonJS_WebViewIFrame'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>155</span> </span><span class="WHIT">                </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.parent.eval</span><span class="PUNC">(</span><span class="NAME">javaScriptCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>156</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>157</span> </span><span class="WHIT">            </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>158</span> </span><span class="WHIT">                </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">frame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.parent.frames</span><span class="PUNC">[</span><span class="STRN">'CocoonJS_App_ForCocoonJS_WebViewIFrame'</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>159</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">frame</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>160</span> </span><span class="WHIT">                    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">frame.window.eval</span><span class="PUNC">(</span><span class="NAME">javaScriptCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>161</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>162</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>163</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>164</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>165</span> 
<span class='line'>166</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>167</span>      * Makes a forward call of some javascript code to be executed in a different environment (i.e. from CocoonJS to the WebView and viceversa).
<span class='line'>168</span>      * It is asyncrhonous so it does not wait until the code is executed and the result of it is returned. Instead, it calls a callback function when the execution has finished to pass the result.
<span class='line'>169</span>      * @function
<span class='line'>170</span>      * @param {string} javaScriptCode Some JavaScript code in a string to be forwarded and executed in a different JavaScript environment (i.e. from CocoonJS to the WebView and viceversa).
<span class='line'>171</span>      * @param {function} [returnCallback] A function callback that will be called when the passed JavaScript code is executed in a different thread to pass the result of the execution in the different JavaScript environment.
<span class='line'>172</span>      */</span><span class="WHIT">
<span class='line'>173</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.forwardAsync</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">javaScriptCode</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">returnCallback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>174</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">isNativeBridgeServiceAvailable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>175</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">returnCallback</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>176</span> </span><span class="WHIT">                </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ext.IDTK_APP.makeCallAsync</span><span class="PUNC">(</span><span class="STRN">"forward"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">javaScriptCode</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">returnCallback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>177</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>178</span> </span><span class="WHIT">            </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>179</span> </span><span class="WHIT">                </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ext.IDTK_APP.makeCallAsync</span><span class="PUNC">(</span><span class="STRN">"forward"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">javaScriptCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>180</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>181</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>182</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>183</span> </span><span class="WHIT">            </span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>184</span> </span><span class="WHIT">                </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">res</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>185</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">window.name</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'CocoonJS_App_ForCocoonJS_WebViewIFrame'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>186</span> </span><span class="WHIT">                    </span><span class="NAME">res</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.parent.eval</span><span class="PUNC">(</span><span class="NAME">javaScriptCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>187</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>188</span> </span><span class="WHIT">                </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>189</span> </span><span class="WHIT">                    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">frame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.parent.frames</span><span class="PUNC">[</span><span class="STRN">'CocoonJS_App_ForCocoonJS_WebViewIFrame'</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>190</span> </span><span class="WHIT">                    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">frame</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>191</span> </span><span class="WHIT">                        </span><span class="NAME">res</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">frame.window.eval</span><span class="PUNC">(</span><span class="NAME">javaScriptCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>192</span> </span><span class="WHIT">                    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>193</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>194</span> </span><span class="WHIT">                </span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">returnCallback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">"function"</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">returnCallback.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">res</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>195</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>196</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>197</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>198</span> 
<span class='line'>199</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>200</span>      * Pops up a text dialog so the user can introduce some text and the application can get it back. It is the first approach CocoonJS has taken to be able to introduce
<span class='line'>201</span>      * text input in a easy way. The dialog execution events are passed to the application through the {@link CocoonJS.App.onTextDialogFinished} and the {@link CocoonJS.App.onTextDialogCancelled} event objects.
<span class='line'>202</span>      * @function
<span class='line'>203</span>      * @param {string} [title] Default value is "". The title to be displayed in the dialog.
<span class='line'>204</span>      * @param {string} [message] Default value is "". The message to be displayed in the dialog, next to the text input field.
<span class='line'>205</span>      * @param {string} [text] Default value is "". The initial text to be introduced in the text input field.
<span class='line'>206</span>      * @param {CocoonJS.App.KeyboardType} [keyboardType] Default value is {@link CocoonJS.App.KeyboardType.TEXT}. The keyboard type to be used when the text has to be introduced.
<span class='line'>207</span>      * @param {string} [cancelButtonText] Default value is "". The text to be displayed in the cancel button of the dialog.
<span class='line'>208</span>      * @param {string} [okButtonText] Default value is "". The text to be displayed in the ok button of the dialog.
<span class='line'>209</span>      * @see CocoonJS.App.onTextDialogFinished
<span class='line'>210</span>      * @see CocoonJS.App.onTextDialogCancelled
<span class='line'>211</span>      */</span><span class="WHIT">
<span class='line'>212</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.showTextDialog</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">title</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">message</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">text</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">keyboardType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">cancelButtonText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">okButtonText</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>213</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>214</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">CocoonJS.makeNativeExtensionObjectFunctionCall</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"showTextDialog"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>215</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>216</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">navigator.isCocoonJS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>217</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">message</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>218</span> </span><span class="WHIT">                </span><span class="NAME">message</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>219</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>220</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">text</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>221</span> </span><span class="WHIT">                </span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>222</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>223</span> </span><span class="WHIT">            </span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>224</span> </span><span class="WHIT">                </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">prompt</span><span class="PUNC">(</span><span class="NAME">message</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">text</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>225</span> </span><span class="WHIT">                </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">eventObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">CocoonJS.App.onTextDialogFinished</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">CocoonJS.App.onTextDialogCancelled</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>226</span> </span><span class="WHIT">                </span><span class="NAME">eventObject.notifyEventListeners</span><span class="PUNC">(</span><span class="NAME">result</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>227</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>228</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>229</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>230</span> 
<span class='line'>231</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>232</span>      * Pops up a message dialog so the user can decide between a yes or no like confirmation. The message box execution events are passed to the application through the {@link CocoonJS.App.onMessageBoxConfirmed} and the {@link CocoonJS.App.onMessageBoxDenied} event objects.
<span class='line'>233</span>      * @function
<span class='line'>234</span>      * @param {string} [title] Default value is "". The title to be displayed in the dialog.
<span class='line'>235</span>      * @param {string} [message] Default value is "". The message to be displayed in the dialog, next to the text input field.
<span class='line'>236</span>      * @param {string} [confirmButtonText] Default value is "Yes". The text to be displayed for the confirm button.
<span class='line'>237</span>      * @param {string} [denyButtonText] Default value is "No". The text to be displayed for the deny button.
<span class='line'>238</span>      * @see CocoonJS.App.onMessageBoxConfirmed
<span class='line'>239</span>      * @see CocoonJS.App.onMessageBoxDenied
<span class='line'>240</span>      */</span><span class="WHIT">
<span class='line'>241</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.showMessageBox</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">title</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">message</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">confirmButtonText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">denyButtonText</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>242</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>243</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">CocoonJS.makeNativeExtensionObjectFunctionCall</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"showMessageBox"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>244</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>245</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">navigator.isCocoonJS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>246</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">message</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>247</span> </span><span class="WHIT">                </span><span class="NAME">message</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>248</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>249</span> </span><span class="WHIT">            </span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>250</span> </span><span class="WHIT">                </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">confirm</span><span class="PUNC">(</span><span class="NAME">message</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>251</span> </span><span class="WHIT">                </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">eventObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">CocoonJS.App.onMessageBoxConfirmed</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">CocoonJS.App.onMessageBoxDenied</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>252</span> </span><span class="WHIT">                </span><span class="NAME">eventObject.notifyEventListeners</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>253</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>254</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>255</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>256</span> 
<span class='line'>257</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>258</span>      * It allows to load a new JavaScript/HTML5 resource that can be loaded either locally (inside the platform/device storage) or using a remote URL.
<span class='line'>259</span>      * @function
<span class='line'>260</span>      * @param {string} path A path to a resource stored in the platform or in a URL to a remote resource.
<span class='line'>261</span>      * @param {CocoonJS.App.StorageType} [storageType] If the path argument represents a locally stored resource, the developer can specify the storage where it is stored. If no value is passes, the {@link CocoonJS.App.StorageType.APP_STORAGE} value is used by default.
<span class='line'>262</span>      */</span><span class="WHIT">
<span class='line'>263</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.load</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">storageType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>264</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>265</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">CocoonJS.makeNativeExtensionObjectFunctionCall</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"loadPath"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>266</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>267</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">navigator.isCocoonJS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>268</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">xhr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XMLHttpRequest</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>269</span> 
<span class='line'>270</span> </span><span class="WHIT">            </span><span class="NAME">xhr.onreadystatechange</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>271</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">xhr.readyState</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>272</span> </span><span class="WHIT">                    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">xhr.status</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">200</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>273</span> </span><span class="WHIT">                        </span><span class="COMM">// TODO: As window load event is not being called (WHY???), I have decided to call the listeners directly</span><span class="WHIT">
<span class='line'>274</span> </span><span class="WHIT">                        </span><span class="COMM">// var callback= function(event){</span><span class="WHIT">
<span class='line'>275</span> </span><span class="WHIT">                        </span><span class="COMM">//     window.removeEventListener("load", callback);</span><span class="WHIT">
<span class='line'>276</span> </span><span class="WHIT">                        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jsCode</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>277</span> </span><span class="WHIT">                        </span><span class="COMM">// If there is no webview, it means we are in the webview, so notify the CocoonJS environment</span><span class="WHIT">
<span class='line'>278</span> </span><span class="WHIT">                        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">CocoonJS.App.EmulatedWebViewIFrame</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>279</span> </span><span class="WHIT">                            </span><span class="NAME">jsCode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"window.CocoonJS && window.CocoonJS.App.onLoadInTheWebViewSucceed.notifyEventListeners('"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"');"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>280</span> </span><span class="WHIT">                        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>281</span> </span><span class="WHIT">                        </span><span class="COMM">// If there is a webview, it means we are in CocoonJS, so notify the webview environment</span><span class="WHIT">
<span class='line'>282</span> </span><span class="WHIT">                        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>283</span> </span><span class="WHIT">                            </span><span class="NAME">jsCode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"window.CocoonJS && window.CocoonJS.App.onLoadInCocoonJSSucceed.notifyEventListeners('"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"');"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>284</span> </span><span class="WHIT">                        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>285</span> </span><span class="WHIT">                        </span><span class="NAME">CocoonJS.App.forwardAsync</span><span class="PUNC">(</span><span class="NAME">jsCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>286</span> </span><span class="WHIT">                        </span><span class="COMM">// };</span><span class="WHIT">
<span class='line'>287</span> </span><span class="WHIT">                        </span><span class="COMM">// window.addEventListener("load", callback);</span><span class="WHIT">
<span class='line'>288</span> </span><span class="WHIT">                        </span><span class="NAME">window.location.href</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">path</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>289</span> </span><span class="WHIT">                    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>290</span> </span><span class="WHIT">                    </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">xhr.status</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">404</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>291</span> </span><span class="WHIT">                        </span><span class="NAME">this.onreadystatechange</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>292</span> </span><span class="WHIT">                        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jsCode</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>293</span> </span><span class="WHIT">                        </span><span class="COMM">// If there is no webview, it means we are in the webview, so notify the CocoonJS environment</span><span class="WHIT">
<span class='line'>294</span> </span><span class="WHIT">                        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">CocoonJS.App.EmulatedWebViewIFrame</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>295</span> </span><span class="WHIT">                            </span><span class="NAME">jsCode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"CocoonJS && CocoonJS.App.onLoadInTheWebViewFailed.notifyEventListeners('"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"');"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>296</span> </span><span class="WHIT">                        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>297</span> </span><span class="WHIT">                        </span><span class="COMM">// If there is a webview, it means we are in CocoonJS, so notify the webview environment</span><span class="WHIT">
<span class='line'>298</span> </span><span class="WHIT">                        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>299</span> </span><span class="WHIT">                            </span><span class="NAME">jsCode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"CocoonJS && CocoonJS.App.onLoadInCocoonJSFailed.notifyEventListeners('"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"');"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>300</span> </span><span class="WHIT">                        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>301</span> </span><span class="WHIT">                        </span><span class="NAME">CocoonJS.App.forwardAsync</span><span class="PUNC">(</span><span class="NAME">jsCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>302</span> </span><span class="WHIT">                    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>303</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>304</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>305</span> </span><span class="WHIT">            </span><span class="NAME">xhr.open</span><span class="PUNC">(</span><span class="STRN">"GET"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">path</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>306</span> </span><span class="WHIT">            </span><span class="NAME">xhr.send</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>307</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>308</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>309</span> 
<span class='line'>310</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>311</span>      * Reloads the last loaded path in the current context.
<span class='line'>312</span>      * @function
<span class='line'>313</span>      */</span><span class="WHIT">
<span class='line'>314</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.reload</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>315</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>316</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">CocoonJS.makeNativeExtensionObjectFunctionCall</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"reload"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>317</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>318</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">navigator.isCocoonJS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>319</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">window.name</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'CocoonJS_App_ForCocoonJS_WebViewIFrame'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>320</span> </span><span class="WHIT">                </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.parent.location.reload</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>321</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>322</span> </span><span class="WHIT">            </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>323</span> </span><span class="WHIT">                </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.parent.frames</span><span class="PUNC">[</span><span class="STRN">'CocoonJS_App_ForCocoonJS_WebViewIFrame'</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">window.location.reload</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>324</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>325</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>326</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>327</span> 
<span class='line'>328</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>329</span>      * Opens a given URL using a system service that is able to open it. For example, open a HTTP URL using the system WebBrowser.+
<span class='line'>330</span>      * @function
<span class='line'>331</span>      * @param {string} url The URL to be opened by a system service.
<span class='line'>332</span>      */</span><span class="WHIT">
<span class='line'>333</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.openURL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>334</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>335</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">CocoonJS.makeNativeExtensionObjectFunctionCall</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"openURL"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>336</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>337</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">navigator.isCocoonJS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>338</span> </span><span class="WHIT">            </span><span class="NAME">window.open</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'_blank'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>339</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>340</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>341</span> 
<span class='line'>342</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>343</span>      * Opens a given share native window to share some specific text content in any system specific social sharing options. For example, Twitter, Facebook, SMS, Mail, ...
<span class='line'>344</span>      * @function
<span class='line'>345</span>      * @param {string} textToShare The text content that will be shared.
<span class='line'>346</span>      */</span><span class="WHIT">
<span class='line'>347</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.share</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">textToShare</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>348</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>349</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">CocoonJS.makeNativeExtensionObjectFunctionCall</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"share"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>350</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>351</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>352</span> </span><span class="WHIT">            </span><span class="COMM">// TODO: Is there something we could do to share in a browser?</span><span class="WHIT">
<span class='line'>353</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>354</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>355</span> 
<span class='line'>356</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>357</span>      * Forces the app to be finished.
<span class='line'>358</span>      * @function
<span class='line'>359</span>      */</span><span class="WHIT">
<span class='line'>360</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.forceToFinish</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>361</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>362</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">CocoonJS.makeNativeExtensionObjectFunctionCall</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"forceToFinish"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>363</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>364</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">navigator.isCocoonJS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>365</span> </span><span class="WHIT">            </span><span class="NAME">window.close</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>366</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>367</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>368</span> 
<span class='line'>369</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>370</span>      * Enables or disables the auto lock to control if the screen keeps on after an inactivity period.
<span class='line'>371</span>      * When the auto lock is enabled and the application has no user input for a short period, the system puts the device into a "sleep state where the screen dims or turns off.
<span class='line'>372</span>      * When the auto lock is disabled the screen keeps on even when there is no user input for long times.
<span class='line'>373</span>      * @param enabled A boolean value that controls whether to enable or disable the auto lock.
<span class='line'>374</span>      */</span><span class="WHIT">
<span class='line'>375</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.setAutoLockEnabled</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">enabled</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>376</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>377</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">CocoonJS.makeNativeExtensionObjectFunctionCall</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"setAutoLockEnabled"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>378</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>379</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>380</span> 
<span class='line'>381</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>382</span>      * Creates a canvas element that is automatically resized to the screen size. When the app is being executed
<span class='line'>383</span>      * inside CocoonJS. This canvas is optimized for rendering so it is higly recommended to use it if it fits
<span class='line'>384</span>      * your app needs. If your app uses one canvas as the main canvas where all other canvases and images are displayed, Ludei recommends to
<span class='line'>385</span>      * call this function in order to create this main canvas. A usual 2x performance gain is achieved by doing so
<span class='line'>386</span>      * depending on the device and the graphics card driver.
<span class='line'>387</span>      * @function
<span class='line'>388</span>      * @return {object} The canvas object that should be used as the main canvas and that is resized to the screen resolution.
<span class='line'>389</span>      */</span><span class="WHIT">
<span class='line'>390</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.createScreenCanvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>391</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">screenCanvas</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>392</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">navigator.isCocoonJS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>393</span> </span><span class="WHIT">            </span><span class="NAME">screenCanvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"screencanvas"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>394</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>395</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">navigator.isCocoonJS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>396</span> </span><span class="WHIT">            </span><span class="NAME">screenCanvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>397</span> </span><span class="WHIT">            </span><span class="NAME">screenCanvas.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.innerWidth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>398</span> </span><span class="WHIT">            </span><span class="NAME">screenCanvas.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.innerHeight</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>399</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>400</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">screenCanvas</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>401</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>402</span> 
<span class='line'>403</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.addADivToDisableInput</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>404</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">div</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>405</span> </span><span class="WHIT">        </span><span class="NAME">div.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"CocoonJSInputBlockingDiv"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>406</span> </span><span class="WHIT">        </span><span class="NAME">div.style.left</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>407</span> </span><span class="WHIT">        </span><span class="NAME">div.style.top</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>408</span> </span><span class="WHIT">        </span><span class="NAME">div.style.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"100%"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>409</span> </span><span class="WHIT">        </span><span class="NAME">div.style.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"100%"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>410</span> </span><span class="WHIT">        </span><span class="NAME">div.style.position</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"absolute"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>411</span> </span><span class="WHIT">        </span><span class="NAME">div.style.backgroundColor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'transparent'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>412</span> </span><span class="WHIT">        </span><span class="NAME">div.style.border</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"0px solid #000"</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>413</span>         </span><span class="NAME">div.style.zIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">999999999</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>414</span> </span><span class="WHIT">        </span><span class="NAME">document.body.appendChild</span><span class="PUNC">(</span><span class="NAME">div</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>415</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>416</span> 
<span class='line'>417</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.removeTheDivToEnableInput</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>418</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">div</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">"CocoonJSInputBlockingDiv"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>419</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">div</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">document.body.removeChild</span><span class="PUNC">(</span><span class="NAME">div</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>420</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>421</span> 
<span class='line'>422</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>423</span>      * Disables the touch events in the CocoonJS environment.
<span class='line'>424</span>      * @function
<span class='line'>425</span>      */</span><span class="WHIT">
<span class='line'>426</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.disableTouchInCocoonJS</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>427</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>428</span> </span><span class="WHIT">            </span><span class="NAME">window.ext.IDTK_APP.makeCall</span><span class="PUNC">(</span><span class="STRN">"disableTouchLayer"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"CocoonJSView"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>429</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>430</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">navigator.isCocoonJS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>431</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">CocoonJS.App.EmulatedWebViewIFrame</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>432</span> </span><span class="WHIT">                </span><span class="NAME">CocoonJS.App.forwardEventsToCocoonJSEnabled</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>433</span> </span><span class="WHIT">                </span><span class="NAME">CocoonJS.App.forwardAsync</span><span class="PUNC">(</span><span class="STRN">"CocoonJS && CocoonJS.App && CocoonJS.App.disableTouchInCocoonJS();"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>434</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>435</span> </span><span class="WHIT">            </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>436</span> </span><span class="WHIT">                </span><span class="COMM">// CocoonJS.App.addADivToDisableInput();</span><span class="WHIT">
<span class='line'>437</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>438</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>439</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>440</span> 
<span class='line'>441</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>442</span>      * Enables the touch events in the CocoonJS environment.
<span class='line'>443</span>      * @function
<span class='line'>444</span>      */</span><span class="WHIT">
<span class='line'>445</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.enableTouchInCocoonJS</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>446</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>447</span> </span><span class="WHIT">            </span><span class="NAME">window.ext.IDTK_APP.makeCall</span><span class="PUNC">(</span><span class="STRN">"enableTouchLayer"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"CocoonJSView"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>448</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>449</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">navigator.isCocoonJS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>450</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">CocoonJS.App.EmulatedWebViewIFrame</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>451</span> </span><span class="WHIT">                </span><span class="NAME">CocoonJS.App.forwardEventsToCocoonJSEnabled</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>452</span> </span><span class="WHIT">                </span><span class="NAME">CocoonJS.App.forwardAsync</span><span class="PUNC">(</span><span class="STRN">"CocoonJS && CocoonJS.App.enableTouchInCocoonJS();"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>453</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>454</span> </span><span class="WHIT">            </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>455</span> </span><span class="WHIT">                </span><span class="COMM">// CocoonJS.App.removeTheDivToEnableInput();</span><span class="WHIT">
<span class='line'>456</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>457</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>458</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>459</span> 
<span class='line'>460</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>461</span>      * Disables the touch events in the WebView environment.
<span class='line'>462</span>      * @function
<span class='line'>463</span>      */</span><span class="WHIT">
<span class='line'>464</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.disableTouchInTheWebView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>465</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>466</span> </span><span class="WHIT">            </span><span class="NAME">window.ext.IDTK_APP.makeCall</span><span class="PUNC">(</span><span class="STRN">"disableTouchLayer"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"WebView"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>467</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>468</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">navigator.isCocoonJS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>469</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">CocoonJS.App.EmulatedWebViewIFrame</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>470</span> </span><span class="WHIT">                </span><span class="NAME">CocoonJS.App.addADivToDisableInput</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>471</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>472</span> </span><span class="WHIT">            </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>473</span> </span><span class="WHIT">                </span><span class="NAME">CocoonJS.App.forwardAsync</span><span class="PUNC">(</span><span class="STRN">"CocoonJS && CocoonJS.App.disableTouchInTheWebView();"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>474</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>475</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>476</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>477</span> 
<span class='line'>478</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>479</span>      * Enables the touch events in the WebView environment.
<span class='line'>480</span>      * @function
<span class='line'>481</span>      */</span><span class="WHIT">
<span class='line'>482</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.enableTouchInTheWebView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>483</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>484</span> </span><span class="WHIT">            </span><span class="NAME">window.ext.IDTK_APP.makeCall</span><span class="PUNC">(</span><span class="STRN">"enableTouchLayer"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"WebView"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>485</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>486</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">navigator.isCocoonJS</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>487</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">CocoonJS.App.EmulatedWebViewIFrame</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>488</span> </span><span class="WHIT">                </span><span class="NAME">CocoonJS.App.removeTheDivToEnableInput</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>489</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>490</span> </span><span class="WHIT">            </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>491</span> </span><span class="WHIT">                </span><span class="NAME">CocoonJS.App.forwardAsync</span><span class="PUNC">(</span><span class="STRN">"CocoonJS && CocoonJS.App.enableTouchInTheWebView();"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>492</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>493</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>494</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>495</span> 
<span class='line'>496</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>497</span>      * Setups the update interval in seconds (1 second / X frames) to receive the accelerometer updates.
<span class='line'>498</span>      * It defines the rate at which the devicemotion events are updated.
<span class='line'>499</span>      * @function
<span class='line'>500</span>      * @param {number} updateIntervalInSeconds The update interval in seconds to be set.
<span class='line'>501</span>      */</span><span class="WHIT">
<span class='line'>502</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.setAccelerometerUpdateIntervalInSeconds</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">updateIntervalInSeconds</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>503</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>504</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.ext.IDTK_APP.makeCall</span><span class="PUNC">(</span><span class="STRN">"setAccelerometerUpdateIntervalInSeconds"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">updateIntervalInSeconds</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>505</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>506</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>507</span> 
<span class='line'>508</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>509</span>      * Returns the update interval in seconds that is currently set for accelerometer related events.
<span class='line'>510</span>      * @function
<span class='line'>511</span>      * @return {number} The update interval in seconds that is currently set for accelerometer related events.
<span class='line'>512</span>      */</span><span class="WHIT">
<span class='line'>513</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.getAccelerometerUpdateIntervalInSeconds</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>514</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>515</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.ext.IDTK_APP.makeCall</span><span class="PUNC">(</span><span class="STRN">"getAccelerometerUpdateIntervalInSeconds"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>516</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>517</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>518</span> 
<span class='line'>519</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>520</span>      * Setups the update interval in seconds (1 second / X frames) to receive the gyroscope updates.
<span class='line'>521</span>      * It defines the rate at which the devicemotion and deviceorientation events are updated.
<span class='line'>522</span>      * @function
<span class='line'>523</span>      * @param {number} updateIntervalInSeconds The update interval in seconds to be set.
<span class='line'>524</span>      */</span><span class="WHIT">
<span class='line'>525</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.setGyroscopeUpdateIntervalInSeconds</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">updateIntervalInSeconds</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>526</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>527</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.ext.IDTK_APP.makeCall</span><span class="PUNC">(</span><span class="STRN">"setGyroscopeUpdateIntervalInSeconds"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">updateIntervalInSeconds</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>528</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>529</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>530</span> 
<span class='line'>531</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>532</span>      * Returns the update interval in seconds that is currently set for gyroscope related events.
<span class='line'>533</span>      * @function
<span class='line'>534</span>      * @return {number} The update interval in seconds that is currently set for gyroscope related events.
<span class='line'>535</span>      */</span><span class="WHIT">
<span class='line'>536</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.getGyroscopeUpdateIntervalInSeconds</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>537</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>538</span> </span><span class="WHIT">            </span><span class="NAME">window.ext.IDTK_APP.makeCall</span><span class="PUNC">(</span><span class="STRN">"getGyroscopeUpdateIntervalInSeconds"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>539</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>540</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>541</span> 
<span class='line'>542</span> 
<span class='line'>543</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>544</span>      * Setups a origin proxy for a given typeName. What this means is that after calling this function the environment that makes this call will suddenly
<span class='line'>545</span>      * have a way of creating instances of the given typeName and those instances will act as a transparent proxy to counterpart instances in the destination environment.
<span class='line'>546</span>      * Manipulating attributes, calling funcitions or handling events will all be performed in the destination environment but the developer will think they will be
<span class='line'>547</span>      * happening in the origin environment.
<span class='line'>548</span>      * IMPORTANT NOTE: These proxies only work with types that use attributes and function parameters and return types that are primitive like numbers, strings or arrays.
<span class='line'>549</span>      * @param {string} typeName The name of the type to be proxified.
<span class='line'>550</span>      * @param {array} [attributeNames] A list of the names of the attributes to be proxified.
<span class='line'>551</span>      * @param {array} [functionNames] A list of the names of the functions to be proxified.
<span class='line'>552</span>      * @param {array} [eventHandlerNames] A list of the names of the event handlers to be proxified (onXXXX like attributes that represent callbacks).
<span class='line'>553</span>      * A valid typeName and at least one valid array for attribute, function or event handler names is mandatory.
<span class='line'>554</span>      */</span><span class="WHIT">
<span class='line'>555</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.setupOriginProxyType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attributeNames</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">functionNames</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventHandlerNames</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>556</span> </span><span class="WHIT">        </span><span class="COMM">// Control the parameters.</span><span class="WHIT">
<span class='line'>557</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">typeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="STRN">"The given typeName must be valid."</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>558</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">attributeNames</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">functionNames</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">eventHandlerNames</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="STRN">"There is no point on setting up a proxy for no attributes, functions nor eventHandlers."</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>559</span> </span><span class="WHIT">        </span><span class="NAME">attributeNames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">attributeNames</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">attributeNames</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>560</span> </span><span class="WHIT">        </span><span class="NAME">functionNames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">functionNames</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">functionNames</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>561</span> </span><span class="WHIT">        </span><span class="NAME">eventHandlerNames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">eventHandlerNames</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">eventHandlerNames</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>562</span> 
<span class='line'>563</span> </span><span class="WHIT">        </span><span class="COMM">// The parent object will be the window. It could be another object but careful, the destination side should know about this.</span><span class="WHIT">
<span class='line'>564</span> </span><span class="WHIT">        </span><span class="COMM">// TODO: Specify the parentObject as a parameter, obtain it's path from the window object and pass it to the destination environment so it knows about it.</span><span class="WHIT">
<span class='line'>565</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>566</span> 
<span class='line'>567</span> </span><span class="WHIT">        </span><span class="COMM">// Setup the destination side too.</span><span class="WHIT">
<span class='line'>568</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jsCode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"CocoonJS.App.setupDestinationProxyType("</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">eventHandlerNames</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">");"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>569</span> </span><span class="WHIT">        </span><span class="NAME">CocoonJS.App.forward</span><span class="PUNC">(</span><span class="NAME">jsCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>570</span> 
<span class='line'>571</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">originalType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>572</span> 
<span class='line'>573</span> </span><span class="WHIT">        </span><span class="COMM">// Constructor. This will be the new proxified type in the origin environment. Instances of this type will be created by the developer without knowing that they are</span><span class="WHIT">
<span class='line'>574</span> </span><span class="WHIT">        </span><span class="COMM">// internally calling to their counterparts in the destination environment.</span><span class="WHIT">
<span class='line'>575</span> </span><span class="WHIT">        </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>576</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_this</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>577</span> 
<span class='line'>578</span> </span><span class="WHIT">            </span><span class="COMM">// Each proxy object will have a origin object inside with all the necessary information to be a proxy to the destination.</span><span class="WHIT">
<span class='line'>579</span> </span><span class="WHIT">            </span><span class="NAME">this._cocoonjs_proxy_object_data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>580</span> </span><span class="WHIT">            </span><span class="COMM">// The id is obtained calling to the destination side to create an instance of the type.</span><span class="WHIT">
<span class='line'>581</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jsCode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"CocoonJS.App.newDestinationProxyObject("</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">");"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>582</span> </span><span class="WHIT">            </span><span class="NAME">this._cocoonjs_proxy_object_data.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">CocoonJS.App.forward</span><span class="PUNC">(</span><span class="NAME">jsCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>583</span> </span><span class="WHIT">            </span><span class="COMM">// The eventHandlers dictionary contains objects of the type { eventHandlerName : string, eventHandler : function } to be able to make the callbacks when the </span><span class="WHIT">
<span class='line'>584</span> </span><span class="WHIT">            </span><span class="COMM">// webview makes the corresponding calls.</span><span class="WHIT">
<span class='line'>585</span> </span><span class="WHIT">            </span><span class="NAME">this._cocoonjs_proxy_object_data.eventHandlers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>586</span> </span><span class="WHIT">            </span><span class="COMM">// Also store the typename inside each instance.</span><span class="WHIT">
<span class='line'>587</span> </span><span class="WHIT">            </span><span class="NAME">this._cocoonjs_proxy_object_data.typeName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">typeName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>588</span> </span><span class="WHIT">            </span><span class="COMM">// A dictionary to store the event handlers</span><span class="WHIT">
<span class='line'>589</span> </span><span class="WHIT">            </span><span class="NAME">this._cocoonjs_proxy_object_data.eventListeners</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>590</span> 
<span class='line'>591</span> </span><span class="WHIT">            </span><span class="COMM">// TODO: eventHandlers and eventListeners should be in the same list ;)</span><span class="WHIT">
<span class='line'>592</span> 
<span class='line'>593</span> </span><span class="WHIT">            </span><span class="COMM">// Store all the proxy instances in a list that belongs to the type itself.</span><span class="WHIT">
<span class='line'>594</span> </span><span class="WHIT">            </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.proxyObjects</span><span class="PUNC">[</span><span class="NAME">this._cocoonjs_proxy_object_data.id</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>595</span> 
<span class='line'>596</span> </span><span class="WHIT">            </span><span class="COMM">// Create a setter and a getter for all the attribute names that have been specified. When the attributes are accessed (set or get) a call to the destination counterpart will be performed.</span><span class="WHIT">
<span class='line'>597</span> </span><span class="WHIT">            </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">attributeNames.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>598</span> </span><span class="WHIT">                </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">attributeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>599</span> </span><span class="WHIT">                    </span><span class="NAME">_this.__defineSetter__</span><span class="PUNC">(</span><span class="NAME">attributeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>600</span> </span><span class="WHIT">                        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jsCode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"CocoonJS.App.setDestinationProxyObjectAttribute("</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">_this._cocoonjs_proxy_object_data.id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">attributeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">");"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>601</span> </span><span class="WHIT">                        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">CocoonJS.App.forward</span><span class="PUNC">(</span><span class="NAME">jsCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>602</span> </span><span class="WHIT">                    </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>603</span> </span><span class="WHIT">                    </span><span class="NAME">_this.__defineGetter__</span><span class="PUNC">(</span><span class="NAME">attributeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>604</span> </span><span class="WHIT">                        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jsCode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"CocoonJS.App.getDestinationProxyObjectAttribute("</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">_this._cocoonjs_proxy_object_data.id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">attributeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">");"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>605</span> </span><span class="WHIT">                        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">CocoonJS.App.forward</span><span class="PUNC">(</span><span class="NAME">jsCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>606</span> </span><span class="WHIT">                    </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>607</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">attributeNames</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>608</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>609</span> 
<span class='line'>610</span> </span><span class="WHIT">            </span><span class="COMM">// Create a function that performs a call to the destination environment counterpart for all the function names that have been specified.</span><span class="WHIT">
<span class='line'>611</span> </span><span class="WHIT">            </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">functionNames.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>612</span> </span><span class="WHIT">                </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">functionName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>613</span> </span><span class="WHIT">                    </span><span class="NAME">_this</span><span class="PUNC">[</span><span class="NAME">functionName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>614</span> </span><span class="WHIT">                        </span><span class="COMM">// Get the arguments as an array and add the typeName, the proxy id and the functionName before all the other arguments before making the call to the destination counterpart.</span><span class="WHIT">
<span class='line'>615</span> </span><span class="WHIT">                        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">argumentsArray</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>616</span> </span><span class="WHIT">                        </span><span class="NAME">argumentsArray.unshift</span><span class="PUNC">(</span><span class="NAME">functionName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>617</span> </span><span class="WHIT">                        </span><span class="NAME">argumentsArray.unshift</span><span class="PUNC">(</span><span class="NAME">this._cocoonjs_proxy_object_data.id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>618</span> </span><span class="WHIT">                        </span><span class="NAME">argumentsArray.unshift</span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>619</span> </span><span class="WHIT">                        </span><span class="COMM">// Use the array to create the correct function call.</span><span class="WHIT">
<span class='line'>620</span> </span><span class="WHIT">                        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jsCode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"CocoonJS.App.callDestinationProxyObjectFunction("</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>621</span> </span><span class="WHIT">                        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">argumentsArray.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>622</span> </span><span class="WHIT">                            </span><span class="COMM">// The second argument (the id) should not be stringified</span><span class="WHIT">
<span class='line'>623</span> </span><span class="WHIT">                            </span><span class="NAME">jsCode</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">argumentsArray</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">argumentsArray</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">argumentsArray.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>624</span> </span><span class="WHIT">                        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>625</span> </span><span class="WHIT">                        </span><span class="NAME">jsCode</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">");"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>626</span> </span><span class="WHIT">                        </span><span class="COMM">// TODO: This next call should be synchronous but it seems that some customers are experiencing some crash issues. Making it async solves these crashes.</span><span class="WHIT">
<span class='line'>627</span> </span><span class="WHIT">                        </span><span class="COMM">// Another possible solution could be to be able to specify which calls could be async and which sync in the proxification array.</span><span class="WHIT">
<span class='line'>628</span> </span><span class="WHIT">                        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">CocoonJS.App.forwardAsync</span><span class="PUNC">(</span><span class="NAME">jsCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>629</span> </span><span class="WHIT">                        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>630</span> </span><span class="WHIT">                    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>631</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">functionNames</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>632</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>633</span> 
<span class='line'>634</span> </span><span class="WHIT">            </span><span class="COMM">// Create a setter and getter for all the event handler names that have been specified. When the event handlers are accessed, store them inside the corresponding position on the eventHandlers</span><span class="WHIT">
<span class='line'>635</span> </span><span class="WHIT">            </span><span class="COMM">// array so they can be called when the destination environment makes the corresponding callback call.</span><span class="WHIT">
<span class='line'>636</span> </span><span class="WHIT">            </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">eventHandlerNames.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>637</span> </span><span class="WHIT">                </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventHandlerName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>638</span> </span><span class="WHIT">                    </span><span class="NAME">_this.__defineSetter__</span><span class="PUNC">(</span><span class="NAME">eventHandlerName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>639</span> </span><span class="WHIT">                        </span><span class="NAME">_this._cocoonjs_proxy_object_data.eventHandlers</span><span class="PUNC">[</span><span class="NAME">eventHandlerName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>640</span> </span><span class="WHIT">                    </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>641</span> </span><span class="WHIT">                    </span><span class="NAME">_this.__defineGetter__</span><span class="PUNC">(</span><span class="NAME">eventHandlerName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>642</span> </span><span class="WHIT">                        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">_this._cocoonjs_proxy_object_data.eventHandlers</span><span class="PUNC">[</span><span class="NAME">eventHandlerName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>643</span> </span><span class="WHIT">                    </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>644</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">eventHandlerNames</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>645</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>646</span> 
<span class='line'>647</span> </span><span class="WHIT">            </span><span class="COMM">// Setup the add and remove event listeners in the proxy object</span><span class="WHIT">
<span class='line'>648</span> </span><span class="WHIT">            </span><span class="NAME">_this.addEventListener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventTypeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventCallback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>649</span> </span><span class="WHIT">                </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">addEventCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>650</span> </span><span class="WHIT">                </span><span class="COMM">// Check for the eventListeners</span><span class="WHIT">
<span class='line'>651</span> </span><span class="WHIT">                </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">eventListeners</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_this._cocoonjs_proxy_object_data.eventListeners</span><span class="PUNC">[</span><span class="NAME">eventTypeName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>652</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventListeners</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>653</span> </span><span class="WHIT">                    </span><span class="COMM">// As the eventListeners were already added, check that the same callback has not been added.</span><span class="WHIT">
<span class='line'>654</span> </span><span class="WHIT">                    </span><span class="NAME">addEventCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">eventListeners.indexOf</span><span class="PUNC">(</span><span class="NAME">eventCallback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>655</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>656</span> </span><span class="WHIT">                </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>657</span> </span><span class="WHIT">                    </span><span class="COMM">// There are no event listeners, so add the one and add the listeners array for the specific event type name</span><span class="WHIT">
<span class='line'>658</span> </span><span class="WHIT">                    </span><span class="NAME">eventListeners</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>659</span> </span><span class="WHIT">                    </span><span class="NAME">_this._cocoonjs_proxy_object_data.eventListeners</span><span class="PUNC">[</span><span class="NAME">eventTypeName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">eventListeners</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>660</span> 
<span class='line'>661</span> </span><span class="WHIT">                    </span><span class="COMM">// Forward the call so the other end registers a event listener (only one is needed).</span><span class="WHIT">
<span class='line'>662</span> </span><span class="WHIT">                    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jsCode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"CocoonJS.App.addDestinationProxyObjectEventListener("</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">_this._cocoonjs_proxy_object_data.typeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">_this._cocoonjs_proxy_object_data.id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">eventTypeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">");"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>663</span> </span><span class="WHIT">                    </span><span class="NAME">CocoonJS.App.forwardAsync</span><span class="PUNC">(</span><span class="NAME">jsCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>664</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>665</span> </span><span class="WHIT">                </span><span class="COMM">// Only if the alforithm above specify so, add the eventcallback and notify the destination environment to do the same</span><span class="WHIT">
<span class='line'>666</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">addEventCallback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>667</span> </span><span class="WHIT">                    </span><span class="NAME">eventListeners.push</span><span class="PUNC">(</span><span class="NAME">eventCallback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>668</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>669</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>670</span> 
<span class='line'>671</span> </span><span class="WHIT">            </span><span class="NAME">_this.removeEventListener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventTypeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventCallback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>672</span> </span><span class="WHIT">                </span><span class="COMM">// Check for the eventListeners</span><span class="WHIT">
<span class='line'>673</span> </span><span class="WHIT">                </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">eventListeners</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_this._cocoonjs_proxy_object_data.eventListeners</span><span class="PUNC">[</span><span class="NAME">eventTypeName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>674</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventListeners</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>675</span> </span><span class="WHIT">                    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">eventCallbackIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">eventListeners.indexOf</span><span class="PUNC">(</span><span class="NAME">eventCallback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>676</span> </span><span class="WHIT">                    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventCallbackIndex</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>677</span> </span><span class="WHIT">                        </span><span class="NAME">eventListeners.splice</span><span class="PUNC">(</span><span class="NAME">eventCallbackIndex</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>678</span> </span><span class="WHIT">                    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>679</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>680</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>681</span> 
<span class='line'>682</span> </span><span class="WHIT">            </span><span class="COMM">// Return the proxy instance.</span><span class="WHIT">
<span class='line'>683</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>684</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>685</span> 
<span class='line'>686</span> </span><span class="WHIT">        </span><span class="COMM">// The type will contain a proxy data structure to store all the instances that are created so they are available when the destination environment calls back. </span><span class="WHIT">
<span class='line'>687</span> </span><span class="WHIT">        </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>688</span> </span><span class="WHIT">        </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>689</span> </span><span class="WHIT">            </span><span class="NAME">originalType</span><span class="PUNC">:</span><span class="NAME">originalType</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>690</span> </span><span class="WHIT">            </span><span class="NAME">proxyObjects</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="WHIT">
<span class='line'>691</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>692</span> 
<span class='line'>693</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'>694</span>          * Deletes a proxy instance from both the CocoonJS environment structures and also deleting it's webview environment counterpart.
<span class='line'>695</span>          * This function should be manually called whenever a proxy instance won't be accessed anymore.
<span class='line'>696</span>          * @param {object} object The proxy object to be deleted.
<span class='line'>697</span>          */</span><span class="WHIT">
<span class='line'>698</span> </span><span class="WHIT">        </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.deleteProxyObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>699</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">proxyObjectKey</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">CocoonJS.getKeyForValueInDictionary</span><span class="PUNC">(</span><span class="NAME">this.proxyObjects</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">object</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>700</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">proxyObjectKey</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>701</span> </span><span class="WHIT">                </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jsCode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"CocoonJS.App.deleteDestinationProxyObject("</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">object._cocoonjs_proxy_object_data.id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">");"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>702</span> </span><span class="WHIT">                </span><span class="NAME">CocoonJS.App.forwardAsync</span><span class="PUNC">(</span><span class="NAME">jsCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>703</span> </span><span class="WHIT">                </span><span class="NAME">object._cocoonjs_proxy_object_data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>704</span> </span><span class="WHIT">                </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.proxyObjects</span><span class="PUNC">[</span><span class="NAME">proxyObjectKey</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>705</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>706</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>707</span> 
<span class='line'>708</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'>709</span>          * Calls a event handler for the given proxy object id and eventHandlerName.
<span class='line'>710</span>          * @param {number} id The id to be used to look for the proxy object for which to make the call to it's event handler.
<span class='line'>711</span>          * @param {string} eventHandlerName The name of the handler to be called.
<span class='line'>712</span>          * NOTE: Events are a complex thing in the HTML specification. This function just performs a call but at least provides a
<span class='line'>713</span>          * structure to the event passing the target (the proxy object).
<span class='line'>714</span>          * TODO: The destination should serialize the event object as far as it can so many parameters can be passed to the origin
<span class='line'>715</span>          * side. Using JSON.stringify in the destination side and parse in origin side maybe? Still must add the target to the event structure though.
<span class='line'>716</span>          */</span><span class="WHIT">
<span class='line'>717</span> </span><span class="WHIT">        </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.callProxyObjectEventHandler</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventHandlerName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>718</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">object</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.proxyObjects</span><span class="PUNC">[</span><span class="NAME">id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>719</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">eventHandler</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">object._cocoonjs_proxy_object_data.eventHandlers</span><span class="PUNC">[</span><span class="NAME">eventHandlerName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>720</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventHandler</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>721</span> </span><span class="WHIT">                </span><span class="NAME">eventHandler</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">:</span><span class="NAME">object</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>722</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>723</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>724</span> 
<span class='line'>725</span> </span><span class="WHIT">        </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.callProxyObjectEventListeners</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventTypeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>726</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">object</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.proxyObjects</span><span class="PUNC">[</span><span class="NAME">id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>727</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">eventListeners</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">object._cocoonjs_proxy_object_data.eventListeners</span><span class="PUNC">[</span><span class="NAME">eventTypeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">slice</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>728</span> </span><span class="WHIT">            </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">eventListeners.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>729</span> </span><span class="WHIT">                </span><span class="NAME">eventListeners</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">:</span><span class="NAME">object</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>730</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>731</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>732</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>733</span> 
<span class='line'>734</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>735</span>      * Takes down the proxification of a type and restores it to it's original type. Do not worry if you pass a type name that is not proxified yet. The
<span class='line'>736</span>      * function will handle it correctly for compativility reasons.
<span class='line'>737</span>      * @param {string} typeName The name of the type to be deproxified (take down the proxification and restore the type to it's original state)
<span class='line'>738</span>      */</span><span class="WHIT">
<span class='line'>739</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.takedownOriginProxyType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>740</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>741</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>742</span> </span><span class="WHIT">            </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.originalType</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>743</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>744</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>745</span> 
<span class='line'>746</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>747</span>      * Deletes everything related to a proxy object in both environments. Do not worry of you do not pass a proxified object to the
<span class='line'>748</span>      * function. For compatibility reasons, you can still have calls to this function even when no poxification of a type has been done.
<span class='line'>749</span>      * @param {object} object The proxified object to be deleted.
<span class='line'>750</span>      */</span><span class="WHIT">
<span class='line'>751</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.deleteOriginProxyObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>752</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>753</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">object</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">object._cocoonjs_proxy_object_data</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>754</span> </span><span class="WHIT">            </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">object._cocoonjs_proxy_object_data.typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.deleteProxyObject</span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>755</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>756</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>757</span> 
<span class='line'>758</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>759</span>      * @ignore
<span class='line'>760</span>      * NOTE: This function should never be directly called. It will be called from the destination environment whenever it is needed to work with proxy objects.
<span class='line'>761</span>      * It calls the origin proxy object when an event handler need to be updated/called from the destination environment.
<span class='line'>762</span>      * @param {string} typeName The type name of the proxified type.
<span class='line'>763</span>      * @param {number} id The id of the proxy object.
<span class='line'>764</span>      * @param {string} eventHandlerName The name of the event handler to be called.
<span class='line'>765</span>      */</span><span class="WHIT">
<span class='line'>766</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.callOriginProxyObjectEventHandler</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventHandlerName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>767</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>768</span> </span><span class="WHIT">        </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.callProxyObjectEventHandler</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventHandlerName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>769</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>770</span> 
<span class='line'>771</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>772</span>      * @ignore
<span class='line'>773</span>      * NOTE: This function should never be directly called. It will be called from the destination environment whenever it is needed to work with proxy objects.
<span class='line'>774</span>      * It calls the origin proxy object when all the event listeners related to a specific event need to be updated/called from the destination environment.
<span class='line'>775</span>      * @param {string} typeName The type name of the proxified type.
<span class='line'>776</span>      * @param {number} id The id of the proxy object.
<span class='line'>777</span>      * @param {string} eventTypeName The name of the event type to call the listeners related to it.
<span class='line'>778</span>      */</span><span class="WHIT">
<span class='line'>779</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.callOriginProxyObjectEventListeners</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventTypeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>780</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>781</span> </span><span class="WHIT">        </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.callProxyObjectEventListeners</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventTypeName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>782</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>783</span> 
<span class='line'>784</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>785</span>      * @ignore
<span class='line'>786</span>      * NOTE: This function should never be directly called. It will be called from the origin environment whenever it is needed to work with proxy objects.
<span class='line'>787</span>      * Setups all the structures that are needed to proxify a destination type to an origin type.
<span class='line'>788</span>      * @param {string} typeName The name of the type to be proxified.
<span class='line'>789</span>      * @param {array} eventHandlerNames An array with al the event handlers to be proxified. Needed in order to be able to create callbacks for all the event handlers
<span class='line'>790</span>      * and call to the CocoonJS counterparts accordingly.
<span class='line'>791</span>      */</span><span class="WHIT">
<span class='line'>792</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.setupDestinationProxyType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventHandlerNames</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>793</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>794</span> 
<span class='line'>795</span> </span><span class="WHIT">        </span><span class="COMM">// Add a cocoonjs structure to the destination proxified type to store some useful information like all the proxy instances that are created, plus the id counter </span><span class="WHIT">
<span class='line'>796</span> </span><span class="WHIT">        </span><span class="COMM">// and the names of all the event handlers and some utility functions.</span><span class="WHIT">
<span class='line'>797</span> </span><span class="WHIT">        </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>798</span> </span><span class="WHIT">        </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>799</span> </span><span class="WHIT">            </span><span class="NAME">nextId</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>800</span> </span><span class="WHIT">            </span><span class="NAME">proxyObjects</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>801</span> </span><span class="WHIT">            </span><span class="NAME">eventHandlerNames</span><span class="PUNC">:</span><span class="NAME">eventHandlerNames</span><span class="WHIT">
<span class='line'>802</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>803</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>804</span> 
<span class='line'>805</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>806</span>      * @ignore
<span class='line'>807</span>      * NOTE: This function should never be directly called. It will be called from the origin environment whenever it is needed to work with proxy objects.
<span class='line'>808</span>      * Takes down the proxy type at the destination environment. Just removes the data structure related to proxies that was added to the type when proxification tool place.
<span class='line'>809</span>      * @param {string} typeName The name of the type to take the proxification down.
<span class='line'>810</span>      */</span><span class="WHIT">
<span class='line'>811</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.takedownDestinationProxyType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>812</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>813</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>814</span> </span><span class="WHIT">            </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>815</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>816</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>817</span> 
<span class='line'>818</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>819</span>      * @ignore
<span class='line'>820</span>      * NOTE: This function should never be directly called. It will be called from the original environment whenever it is needed to work with proxy objects.
<span class='line'>821</span>      * Creates a new destination object instance and generates a id to reference it from the original environment.
<span class='line'>822</span>      * @param {string} typeName The name of the type to be proxified and to generate an instance.
<span class='line'>823</span>      * @return The id to be used from the original environment to identify the corresponding destination object instance.
<span class='line'>824</span>      */</span><span class="WHIT">
<span class='line'>825</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.newDestinationProxyObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>826</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>827</span> 
<span class='line'>828</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">proxyObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>829</span> </span><span class="WHIT">        </span><span class="COMM">// Also store some additional information in the proxy object</span><span class="WHIT">
<span class='line'>830</span> </span><span class="WHIT">        </span><span class="NAME">proxyObject._cocoonjs_proxy_object_data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>831</span> </span><span class="WHIT">        </span><span class="COMM">// Like the type name, that could be useful late ;)</span><span class="WHIT">
<span class='line'>832</span> </span><span class="WHIT">        </span><span class="NAME">proxyObject._cocoonjs_proxy_object_data.typeName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">typeName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>833</span> </span><span class="WHIT">        </span><span class="COMM">// Caculate the id for the object. It will be returned to the origin environment so this object can be referenced later</span><span class="WHIT">
<span class='line'>834</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">proxyObjectId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.nextId</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>835</span> </span><span class="WHIT">        </span><span class="COMM">// Store the created object in the structure defined in the setup of proxification with an id associated to it</span><span class="WHIT">
<span class='line'>836</span> </span><span class="WHIT">        </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.proxyObjects</span><span class="PUNC">[</span><span class="NAME">proxyObjectId</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">proxyObject</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>837</span> </span><span class="WHIT">        </span><span class="COMM">// Also store the id inside the proxy object itself</span><span class="WHIT">
<span class='line'>838</span> </span><span class="WHIT">        </span><span class="NAME">proxyObject._cocoonjs_proxy_object_data.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">proxyObjectId</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>839</span> </span><span class="WHIT">        </span><span class="COMM">// Calculate a new id for the next object.</span><span class="WHIT">
<span class='line'>840</span> </span><span class="WHIT">        </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.nextId</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>841</span> 
<span class='line'>842</span> </span><span class="WHIT">        </span><span class="COMM">// Setup all the event handlers.</span><span class="WHIT">
<span class='line'>843</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.eventHandlerNames.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>844</span> </span><span class="WHIT">            </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">eventHandlerName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>845</span> </span><span class="WHIT">                </span><span class="NAME">proxyObject</span><span class="PUNC">[</span><span class="NAME">eventHandlerName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>846</span> </span><span class="WHIT">                    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">proxyObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// event.target;</span><span class="WHIT">
<span class='line'>847</span> </span><span class="WHIT">                    </span><span class="COMM">// var eventHandlerName = CocoonJS.getKeyForValueInDictionary(proxyObject, this); // Avoid closures ;)</span><span class="WHIT">
<span class='line'>848</span> </span><span class="WHIT">                    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jsCode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"CocoonJS.App.callOriginProxyObjectEventHandler("</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">proxyObject._cocoonjs_proxy_object_data.typeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">proxyObject._cocoonjs_proxy_object_data.id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">eventHandlerName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">");"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>849</span> </span><span class="WHIT">                    </span><span class="NAME">CocoonJS.App.forwardAsync</span><span class="PUNC">(</span><span class="NAME">jsCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>850</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>851</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.eventHandlerNames</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>852</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>853</span> 
<span class='line'>854</span> </span><span class="WHIT">        </span><span class="COMM">// Add the dictionary where the event listeners (callbacks) will be added.</span><span class="WHIT">
<span class='line'>855</span> </span><span class="WHIT">        </span><span class="NAME">proxyObject._cocoonjs_proxy_object_data.eventListeners</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>856</span> 
<span class='line'>857</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">proxyObjectId</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>858</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>859</span> 
<span class='line'>860</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>861</span>      * @ignore
<span class='line'>862</span>      * NOTE: This function should never be directly called. It will be called from the origin environement whenever it is needed to work with proxy objects.
<span class='line'>863</span>      * Calls a function of a destination object idetified by it's typeName and id.
<span class='line'>864</span>      * @param {string} typeName The name of the type of the proxy.
<span class='line'>865</span>      * @param {number} id The id of the proxy object.
<span class='line'>866</span>      * @param {string} functionName The name of the function to be called.
<span class='line'>867</span>      * @return Whatever the function call returns.
<span class='line'>868</span>      */</span><span class="WHIT">
<span class='line'>869</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.callDestinationProxyObjectFunction</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">functionName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>870</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>871</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">argumentsArray</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>872</span> </span><span class="WHIT">        </span><span class="NAME">argumentsArray.splice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>873</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">proxyObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.proxyObjects</span><span class="PUNC">[</span><span class="NAME">id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>874</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">proxyObject</span><span class="PUNC">[</span><span class="NAME">functionName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="NAME">proxyObject</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">argumentsArray</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>875</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>876</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>877</span> 
<span class='line'>878</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>879</span>      * @ignore
<span class='line'>880</span>      * NOTE: This function should never be directly called. It will be called from the original environment whenever it is needed to work with proxy objects.
<span class='line'>881</span>      * Sets a value to the corresponding attributeName of a proxy object represented by it's typeName and id.
<span class='line'>882</span>      * @param {string} typeName The name of the type of the proxy.
<span class='line'>883</span>      * @param {number} id The id of the proxy object.
<span class='line'>884</span>      * @param {string} attributeName The name of the attribute to be set.
<span class='line'>885</span>      * @param {unknown} attributeValue The value to be set to the attribute.
<span class='line'>886</span>      */</span><span class="WHIT">
<span class='line'>887</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.setDestinationProxyObjectAttribute</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attributeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attributeValue</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>888</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>889</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">proxyObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.proxyObjects</span><span class="PUNC">[</span><span class="NAME">id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>890</span> </span><span class="WHIT">        </span><span class="NAME">proxyObject</span><span class="PUNC">[</span><span class="NAME">attributeName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">attributeValue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>891</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>892</span> 
<span class='line'>893</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>894</span>      * @ignore
<span class='line'>895</span>      * NOTE: This function should never be directly called. It will be called from the original environment whenever it is needed to work with proxy objects.
<span class='line'>896</span>      * Retrieves the value of the corresponding attributeName of a proxy object represented by it's typeName and id.
<span class='line'>897</span>      * @param {string} typeName The name of the type of the proxy.
<span class='line'>898</span>      * @param {number} id The id of the proxy object.
<span class='line'>899</span>      * @param {string} attributeName The name of the attribute to be retrieved.
<span class='line'>900</span>      */</span><span class="WHIT">
<span class='line'>901</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.getDestinationProxyObjectAttribute</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attributeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>902</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>903</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">proxyObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.proxyObjects</span><span class="PUNC">[</span><span class="NAME">id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>904</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">proxyObject</span><span class="PUNC">[</span><span class="NAME">attributeName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>905</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>906</span> 
<span class='line'>907</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>908</span>      * @ignore
<span class='line'>909</span>      * NOTE: This function should never be directly called. It will be called from the original environment whenever it is needed to work with proxy objects.
<span class='line'>910</span>      * Deletes a proxy object identifying it using it's typeName and id. Deleting a proxy object mainly means to remove the instance from the global structure
<span class='line'>911</span>      * that hold all the instances.
<span class='line'>912</span>      * @param {string} typeName The name of the type of the proxy.
<span class='line'>913</span>      * @param {number} id The id of the proxy object.
<span class='line'>914</span>      */</span><span class="WHIT">
<span class='line'>915</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.deleteDestinationProxyObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>916</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>917</span> </span><span class="WHIT">        </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.proxyObjects</span><span class="PUNC">[</span><span class="NAME">id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>918</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>919</span> 
<span class='line'>920</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>921</span>      * @ignore
<span class='line'>922</span>      * NOTE: This function should never be directly called. It will be called from the original environment whenever it is needed to work with proxy objects.
<span class='line'>923</span>      */</span><span class="WHIT">
<span class='line'>924</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.addDestinationProxyObjectEventListener</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventTypeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>925</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>926</span> </span><span class="WHIT">        </span><span class="COMM">// Look for the proxy object</span><span class="WHIT">
<span class='line'>927</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">proxyObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parentObject</span><span class="PUNC">[</span><span class="NAME">typeName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">_cocoonjs_proxy_type_data.proxyObjects</span><span class="PUNC">[</span><span class="NAME">id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>928</span> 
<span class='line'>929</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>930</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">proxyObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// event.target;</span><span class="WHIT">
<span class='line'>931</span> </span><span class="WHIT">            </span><span class="COMM">// var eventTypeName = CocoonJS.getKeyForValueInDictionary(proxyObject._cocoonjs_proxy_object_data.eventListeners, this); // Avoid closures ;)</span><span class="WHIT">
<span class='line'>932</span> </span><span class="WHIT">            </span><span class="COMM">// TODO: Is there a way to retrieve the callbackId without a closure?</span><span class="WHIT">
<span class='line'>933</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jsCode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"CocoonJS.App.callOriginProxyObjectEventListeners("</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">proxyObject._cocoonjs_proxy_object_data.typeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">proxyObject._cocoonjs_proxy_object_data.id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">eventTypeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">");"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>934</span> </span><span class="WHIT">            </span><span class="NAME">CocoonJS.App.forwardAsync</span><span class="PUNC">(</span><span class="NAME">jsCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>935</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>936</span> 
<span class='line'>937</span> </span><span class="WHIT">        </span><span class="NAME">proxyObject._cocoonjs_proxy_object_data.eventListeners</span><span class="PUNC">[</span><span class="NAME">eventTypeName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>938</span> 
<span class='line'>939</span> </span><span class="WHIT">        </span><span class="COMM">// Finally add the event listener callback to the proxy object</span><span class="WHIT">
<span class='line'>940</span> </span><span class="WHIT">        </span><span class="NAME">proxyObject.addEventListener</span><span class="PUNC">(</span><span class="NAME">eventTypeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>941</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>942</span> 
<span class='line'>943</span> </span><span class="WHIT">    </span><span class="COMM">// TODO: We could add a removeDestinationProxyObjectEventListener although it seems that is not completely necessary.</span><span class="WHIT">
<span class='line'>944</span> 
<span class='line'>945</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>946</span>      * Proxifies the XMLHttpRequest type for the environment where this call is made. After calling this function, all the new objects
<span class='line'>947</span>      * of XMLHttpRequest that are instantiated, will be proxified objects that will make calls to the counterparts in the other environment (CocoonJS &lt;-> WebView viceversa).
<span class='line'>948</span>      * IMPORTANT NOTE: Remember to take down the proxification once you are done or to delete proxy objects whenever they are not needed anymore or memory leaks may occur.
<span class='line'>949</span>      */</span><span class="WHIT">
<span class='line'>950</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.proxifyXHR</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>951</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ATTRIBUTE_NAMES</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>952</span> </span><span class="WHIT">            </span><span class="PUNC">[</span><span class="WHIT">
<span class='line'>953</span> </span><span class="WHIT">                </span><span class="STRN">"timeout"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>954</span> </span><span class="WHIT">                </span><span class="STRN">"withCredentials"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>955</span> </span><span class="WHIT">                </span><span class="STRN">"upload"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>956</span> </span><span class="WHIT">                </span><span class="STRN">"status"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>957</span> </span><span class="WHIT">                </span><span class="STRN">"statusText"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>958</span> </span><span class="WHIT">                </span><span class="STRN">"responseType"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>959</span> </span><span class="WHIT">                </span><span class="STRN">"response"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>960</span> </span><span class="WHIT">                </span><span class="STRN">"responseText"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>961</span> </span><span class="WHIT">                </span><span class="STRN">"responseXML"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>962</span> </span><span class="WHIT">                </span><span class="STRN">"readyState"</span><span class="WHIT">
<span class='line'>963</span> </span><span class="WHIT">            </span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>964</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">FUNCTION_NAMES</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>965</span> </span><span class="WHIT">            </span><span class="PUNC">[</span><span class="WHIT">
<span class='line'>966</span> </span><span class="WHIT">                </span><span class="STRN">"open"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>967</span> </span><span class="WHIT">                </span><span class="STRN">"setRequestHeader"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>968</span> </span><span class="WHIT">                </span><span class="STRN">"send"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>969</span> </span><span class="WHIT">                </span><span class="STRN">"abort"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>970</span> </span><span class="WHIT">                </span><span class="STRN">"getResponseHeader"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>971</span> </span><span class="WHIT">                </span><span class="STRN">"getAllResponseHeaders"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>972</span> </span><span class="WHIT">                </span><span class="STRN">"overrideMimeType"</span><span class="WHIT">
<span class='line'>973</span> </span><span class="WHIT">            </span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>974</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">EVENT_HANDLER_NAMES</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>975</span> </span><span class="WHIT">            </span><span class="PUNC">[</span><span class="WHIT">
<span class='line'>976</span> </span><span class="WHIT">                </span><span class="STRN">"onloadstart"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>977</span> </span><span class="WHIT">                </span><span class="STRN">"onprogress"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>978</span> </span><span class="WHIT">                </span><span class="STRN">"onabort"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>979</span> </span><span class="WHIT">                </span><span class="STRN">"onerror"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>980</span> </span><span class="WHIT">                </span><span class="STRN">"onload"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>981</span> </span><span class="WHIT">                </span><span class="STRN">"ontimeout"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>982</span> </span><span class="WHIT">                </span><span class="STRN">"onloadend"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>983</span> </span><span class="WHIT">                </span><span class="STRN">"onreadystatechange"</span><span class="WHIT">
<span class='line'>984</span> </span><span class="WHIT">            </span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>985</span> </span><span class="WHIT">        </span><span class="NAME">CocoonJS.App.setupOriginProxyType</span><span class="PUNC">(</span><span class="STRN">"XMLHttpRequest"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ATTRIBUTE_NAMES</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">FUNCTION_NAMES</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">EVENT_HANDLER_NAMES</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>986</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>987</span> 
<span class='line'>988</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>989</span>      * Proxifies the Audio type for the environment where this call is made. After calling this function, all the new objects
<span class='line'>990</span>      * of Audio that are instantiated, will be proxified objects that will make calls to the counterparts in the other environment (CocoonJS &lt;-> WebView viceversa).
<span class='line'>991</span>      * IMPORTANT NOTE: Remember to take down the proxification once you are done or to delete proxy objects whenever they are not needed anymore or memory leaks may occur.
<span class='line'>992</span>      */</span><span class="WHIT">
<span class='line'>993</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.proxifyAudio</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>994</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ATTRIBUTE_NAMES</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>995</span> </span><span class="WHIT">            </span><span class="PUNC">[</span><span class="WHIT">
<span class='line'>996</span> </span><span class="WHIT">                </span><span class="STRN">"src"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>997</span> </span><span class="WHIT">                </span><span class="STRN">"loop"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>998</span> </span><span class="WHIT">                </span><span class="STRN">"volume"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>999</span> </span><span class="WHIT">                </span><span class="STRN">"preload"</span><span class="WHIT">
<span class='line'>1000</span> </span><span class="WHIT">            </span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1001</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">FUNCTION_NAMES</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>1002</span> </span><span class="WHIT">            </span><span class="PUNC">[</span><span class="WHIT">
<span class='line'>1003</span> </span><span class="WHIT">                </span><span class="STRN">"play"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1004</span> </span><span class="WHIT">                </span><span class="STRN">"pause"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1005</span> </span><span class="WHIT">                </span><span class="STRN">"load"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1006</span> </span><span class="WHIT">                </span><span class="STRN">"canPlayType"</span><span class="WHIT">
<span class='line'>1007</span> </span><span class="WHIT">            </span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1008</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">EVENT_HANDLER_NAMES</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>1009</span> </span><span class="WHIT">            </span><span class="PUNC">[</span><span class="WHIT">
<span class='line'>1010</span> </span><span class="WHIT">                </span><span class="STRN">"onended"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1011</span> </span><span class="WHIT">                </span><span class="STRN">"oncanplay"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1012</span> </span><span class="WHIT">                </span><span class="STRN">"oncanplaythrough"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1013</span> </span><span class="WHIT">                </span><span class="STRN">"onerror"</span><span class="WHIT">
<span class='line'>1014</span> </span><span class="WHIT">            </span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1015</span> </span><span class="WHIT">        </span><span class="NAME">CocoonJS.App.setupOriginProxyType</span><span class="PUNC">(</span><span class="STRN">"Audio"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ATTRIBUTE_NAMES</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">FUNCTION_NAMES</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">EVENT_HANDLER_NAMES</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1016</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1017</span> 
<span class='line'>1018</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1019</span>      * Captures a image of the screen synchronously and saves it to a file. Sync mode allows to capture the screen in the middle of a frame rendering.
<span class='line'>1020</span>      * @function captureScreen
<span class='line'>1021</span>      * @param {string} fileName Desired file name and format (png or jpg). If no value is passed, "capture.png" value is used by default
<span class='line'>1022</span>      * @param {CocoonJS.App.StorageType} storageType The developer can specify the storage where it is stored. If no value is passed, the {@link CocoonJS.App.StorageType.TMP_STORAGE} value is used by default.
<span class='line'>1023</span>      * @param {CocoonJS.App.CaptureType} captureType Optional value to choose capture type. See {@link CocoonJS.App.CaptureType}.
<span class='line'>1024</span>      * - 0: Captures everything.
<span class='line'>1025</span>      * - 1: Only captures cocoonjs surface.
<span class='line'>1026</span>      * - 2: Only captures system views.
<span class='line'>1027</span>      * @param {boolean} saveToGallery Optional value to specify if the capture image should be stored in the device image gallery or not.
<span class='line'>1028</span>      * @throws exception if the image fails to be stored or there is another error.
<span class='line'>1029</span>      * @return The URL of the saved file.
<span class='line'>1030</span>      * @example
<span class='line'>1031</span>      * CocoonJS.App.captureScreen("myScreenshot.png");
<span class='line'>1032</span>      * @see CocoonJS.App.onCaptureScreenSucceeded
<span class='line'>1033</span>      * @see CocoonJS.App.onCaptureScreenFailed
<span class='line'>1034</span>      */</span><span class="WHIT">
<span class='line'>1035</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.captureScreen</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fileName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">storageType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">captureType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1036</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1037</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.ext.IDTK_APP.makeCall</span><span class="PUNC">(</span><span class="STRN">"captureScreen"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fileName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">storageType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">captureType</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1038</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1039</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1040</span> 
<span class='line'>1041</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1042</span>      * Captures a image of the screen asynchronously and saves it to a file.
<span class='line'>1043</span>      * Async mode captures a final frame as soon as possible.
<span class='line'>1044</span>      * @function captureScreenAsync
<span class='line'>1045</span>      * @memberof CocoonJS.App
<span class='line'>1046</span>      * @param {string} fileName Desired file name and format (png or jpg). If no value is passed, "capture.png" value is used by default
<span class='line'>1047</span>      * @param {CocoonJS.App.StorageType} storageType The developer can specify the storage where it is stored. If no value is passed, the {@see CocoonJS.App.StorageType.TEMPORARY_STORAGE} value is used by default.
<span class='line'>1048</span>      * @param {CocoonJS.App.CaptureType} captureType Optional value to choose capture type. See {@link CocoonJS.App.CaptureType}.
<span class='line'>1049</span>      * - 0: Captures everything.
<span class='line'>1050</span>      * - 1: Only captures cocoonjs surface.
<span class='line'>1051</span>      * - 2: Only captures system views.
<span class='line'>1052</span>      * @param {boolean} saveToGallery Optional value to specify if the capture image should be stored in the device image gallery or not.
<span class='line'>1053</span>      * @param {function} callback Response callback, check the error property to monitor errors. Check the 'url' property to get the URL of the saved Image
<span class='line'>1054</span>      * @example
<span class='line'>1055</span>      * CocoonJS.App.captureScreenAsync("myScreenshot.png", CocoonJS.App.StorageType.TEMPORARY_STORAGE, false, CocoonJS.App.CaptureType.EVERYTHING, function(url, err){
<span class='line'>1056</span>      * ...
<span class='line'>1057</span>      * });
<span class='line'>1058</span>      */</span><span class="WHIT">
<span class='line'>1059</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.captureScreenAsync</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fileName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">storageType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">captureType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1060</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1061</span> </span><span class="WHIT">            </span><span class="NAME">window.ext.IDTK_APP.makeCallAsync</span><span class="PUNC">(</span><span class="STRN">"captureScreen"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fileName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">storageType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">captureType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1062</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1063</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1064</span> 
<span class='line'>1065</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1066</span>      * Returns the device UUID
<span class='line'>1067</span>      * @return {string} The device UUID
<span class='line'>1068</span>      */</span><span class="WHIT">
<span class='line'>1069</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.getDeviceId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1070</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1071</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.ext.IDTK_APP.makeCall</span><span class="PUNC">(</span><span class="STRN">"getDeviceId"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1072</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1073</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1074</span> 
<span class='line'>1075</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1076</span>      * Structure that defines the getDeviceInfo returned information
<span class='line'>1077</span>      */</span><span class="WHIT">
<span class='line'>1078</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.DeviceInfo</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1079</span> 
<span class='line'>1080</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'>1081</span>         * The operating system name (ios, android,...)
<span class='line'>1082</span>         * @type string
<span class='line'>1083</span>         */</span><span class="WHIT">
<span class='line'>1084</span> </span><span class="WHIT">        </span><span class="NAME">os</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1085</span> 
<span class='line'>1086</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'>1087</span>         * The operating system version (4.2.2, 5.0,...)
<span class='line'>1088</span>         * @type string
<span class='line'>1089</span>         */</span><span class="WHIT">
<span class='line'>1090</span> </span><span class="WHIT">        </span><span class="NAME">version</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1091</span> 
<span class='line'>1092</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'>1093</span>         * The operating system screen density in dpi
<span class='line'>1094</span>         * @type string
<span class='line'>1095</span>         */</span><span class="WHIT">
<span class='line'>1096</span> </span><span class="WHIT">        </span><span class="NAME">dpi</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1097</span> 
<span class='line'>1098</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'>1099</span>         * The device manufacturer (apple, samsung, lg,...)
<span class='line'>1100</span>         * @type string
<span class='line'>1101</span>         */</span><span class="WHIT">
<span class='line'>1102</span> </span><span class="WHIT">        </span><span class="NAME">brand</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1103</span> 
<span class='line'>1104</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'>1105</span>         * The device model (iPhone 4S, SAMSUNG-SGH-I997, SAMSUNG-SGH-I997R, etc)
<span class='line'>1106</span>         * @type string
<span class='line'>1107</span>         */</span><span class="WHIT">
<span class='line'>1108</span> </span><span class="WHIT">        </span><span class="NAME">model</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1109</span> 
<span class='line'>1110</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'>1111</span>         * The phone IMEI
<span class='line'>1112</span>         * Android: The phone IMEI is returned or null if the device has not telepohny
<span class='line'>1113</span>         * iOS: null is returned as we cannot get the IMEI in iOS, no public API available for that yet.
<span class='line'>1114</span>         * @type string
<span class='line'>1115</span>         */</span><span class="WHIT">
<span class='line'>1116</span> </span><span class="WHIT">        </span><span class="NAME">imei</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1117</span> 
<span class='line'>1118</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'>1119</span>         * The platform Id
<span class='line'>1120</span>         * Android: The ANDROID_ID is used.
<span class='line'>1121</span>         * iOS: The OpenUDID is used as there is no Android ANDROID_ID equivalent in iOS
<span class='line'>1122</span>         * @type string
<span class='line'>1123</span>         */</span><span class="WHIT">
<span class='line'>1124</span> </span><span class="WHIT">        </span><span class="NAME">platformId</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1125</span> 
<span class='line'>1126</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'>1127</span>         * The Odin generated id https://code.google.com/p/odinmobile/
<span class='line'>1128</span>         * @type string
<span class='line'>1129</span>         */</span><span class="WHIT">
<span class='line'>1130</span> </span><span class="WHIT">        </span><span class="NAME">odin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1131</span> 
<span class='line'>1132</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'>1133</span>         * The OpenUDID generated Id https://github.com/ylechelle/OpenUDID
<span class='line'>1134</span>         * @type string
<span class='line'>1135</span>         */</span><span class="WHIT">
<span class='line'>1136</span> </span><span class="WHIT">        </span><span class="NAME">openudid</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT">
<span class='line'>1137</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1138</span> 
<span class='line'>1139</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1140</span>      * Returns the device Info
<span class='line'>1141</span>      * @return {CocoonJS.App.DeviceInfo} The device Info
<span class='line'>1142</span>      */</span><span class="WHIT">
<span class='line'>1143</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.getDeviceInfo</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1144</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1145</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.ext.IDTK_APP.makeCall</span><span class="PUNC">(</span><span class="STRN">"getDeviceInfo"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1146</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1147</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1148</span> 
<span class='line'>1149</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1150</span>      *
<span class='line'>1151</span>      * @constructor
<span class='line'>1152</span>      */</span><span class="WHIT">
<span class='line'>1153</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.WebDialog</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1154</span> 
<span class='line'>1155</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1156</span> </span><span class="WHIT">            </span><span class="NAME">this.webDialogID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.ext.IDTK_APP.makeCall</span><span class="PUNC">(</span><span class="STRN">"createWebDialog"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1157</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1158</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1159</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">iframe</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"iframe"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1160</span> </span><span class="WHIT">            </span><span class="NAME">iframe.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"CocoonJSWebDialogIFrame"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1161</span> </span><span class="WHIT">            </span><span class="NAME">iframe.name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"CocoonJSWebDialogIFrame"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1162</span> </span><span class="WHIT">            </span><span class="NAME">iframe.style.cssText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"position:fixed;left:0;top:0;bottom:0;right:0; width:100%; height:100%;margin:0;padding:0;"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1163</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">me</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1164</span> </span><span class="WHIT">            </span><span class="NAME">iframe.onload</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1165</span> </span><span class="WHIT">                </span><span class="NAME">me.iframeloaded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1166</span> </span><span class="WHIT">                </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">js</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"CocoonJS = {}; CocoonJS.WebDialog = {}; CocoonJS.WebDialog.close = function()"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>1167</span> </span><span class="WHIT">                    </span><span class="STRN">"{"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>1168</span> </span><span class="WHIT">                    </span><span class="STRN">"   window.parent.CocoonJSCloseWebDialog();"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>1169</span> </span><span class="WHIT">                    </span><span class="STRN">"};"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1170</span> </span><span class="WHIT">                </span><span class="NAME">me.evalIframe</span><span class="PUNC">(</span><span class="NAME">js</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1171</span> </span><span class="WHIT">                </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">me.pendingEvals.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">++</span><span class="NAME">i</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1172</span> </span><span class="WHIT">                    </span><span class="NAME">me.evalIframe</span><span class="PUNC">(</span><span class="NAME">me.pendingEvals</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1173</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1174</span> </span><span class="WHIT">                </span><span class="NAME">me.pendingEvals</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1175</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1176</span> </span><span class="WHIT">            </span><span class="NAME">iframe.onerror</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1177</span> </span><span class="WHIT">                </span><span class="NAME">me.close</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1178</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1179</span> </span><span class="WHIT">            </span><span class="NAME">this.iframe</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">iframe</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1180</span> </span><span class="WHIT">            </span><span class="NAME">this.pendingEvals</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1181</span> 
<span class='line'>1182</span> </span><span class="WHIT">            </span><span class="NAME">window.CocoonJSCloseWebDialog</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1183</span> </span><span class="WHIT">               </span><span class="NAME">me.close</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1184</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1185</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1186</span> 
<span class='line'>1187</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1188</span> 
<span class='line'>1189</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.WebDialog.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1190</span> 
<span class='line'>1191</span> </span><span class="WHIT">        </span><span class="NAME">show</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1192</span> </span><span class="WHIT">            </span><span class="NAME">this.closeCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1193</span> </span><span class="WHIT">                </span><span class="NAME">CocoonJS.App.enableTouchInCocoonJS</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1194</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1195</span> </span><span class="WHIT">                    </span><span class="NAME">callback</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1196</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1197</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1198</span> </span><span class="WHIT">                </span><span class="NAME">CocoonJS.App.disableTouchInCocoonJS</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1199</span> </span><span class="WHIT">                </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.ext.IDTK_APP.makeCallAsync</span><span class="PUNC">(</span><span class="STRN">"showWebDialog"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.webDialogID</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">url</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.closeCallback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1200</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1201</span> </span><span class="WHIT">            </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1202</span> </span><span class="WHIT">                </span><span class="NAME">this.iframe.src</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">url</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1203</span> </span><span class="WHIT">                </span><span class="NAME">document.body.appendChild</span><span class="PUNC">(</span><span class="NAME">this.iframe</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1204</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1205</span> 
<span class='line'>1206</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1207</span> </span><span class="WHIT">        </span><span class="NAME">close</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1208</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1209</span> </span><span class="WHIT">                </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.ext.IDTK_APP.makeCallAsync</span><span class="PUNC">(</span><span class="STRN">"closeWebDialog"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.webDialogID</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1210</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1211</span> </span><span class="WHIT">            </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1212</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.iframe.parentNode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1213</span> </span><span class="WHIT">                    </span><span class="NAME">this.iframe.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">this.iframe</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1214</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1215</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1216</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.closeCallback</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1217</span> </span><span class="WHIT">                </span><span class="NAME">this.closeCallback</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1218</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1219</span> </span><span class="WHIT">        </span><span class="NAME">evalIframe</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">js</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1220</span> </span><span class="WHIT">            </span><span class="NAME">window.frames</span><span class="PUNC">[</span><span class="STRN">"CocoonJSWebDialogIFrame"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">eval</span><span class="PUNC">(</span><span class="NAME">js</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1221</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1222</span> </span><span class="WHIT">        </span><span class="NAME">eval</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">js</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1223</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1224</span> </span><span class="WHIT">                </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.ext.IDTK_APP.makeCallAsync</span><span class="PUNC">(</span><span class="STRN">"evalWebDialog"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.webDialogID</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">js</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1225</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1226</span> </span><span class="WHIT">            </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1227</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.iframeloaded</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1228</span> </span><span class="WHIT">                    </span><span class="NAME">this.evalIframe</span><span class="PUNC">(</span><span class="NAME">js</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1229</span> </span><span class="WHIT">                </span><span class="KEYW">else</span><span class="WHIT">
<span class='line'>1230</span> </span><span class="WHIT">                    </span><span class="NAME">this.pendingEvals.push</span><span class="PUNC">(</span><span class="NAME">js</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1231</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1232</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1233</span> 
<span class='line'>1234</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1235</span> 
<span class='line'>1236</span> 
<span class='line'>1237</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1238</span>     * Retrieves the preferred orientation that has been set in the system.
<span class='line'>1239</span>     * @return {number} The preferred orientation in the system as a combination of the possible {@link CocoonJS.App.Orientations}
<span class='line'>1240</span>     */</span><span class="WHIT">
<span class='line'>1241</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.getPreferredOrientation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1242</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1243</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.ext.IDTK_APP.makeCall</span><span class="PUNC">(</span><span class="STRN">"getPreferredOrientation"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1244</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1245</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1246</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1247</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1248</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1249</span> 
<span class='line'>1250</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1251</span>     * Sets the preferred orientation in the system.
<span class='line'>1252</span>     * @param {number} preferredOrientation The preferred orientation to be set. A combinatio of the possible {@link CocoonJS.App.Orientations}
<span class='line'>1253</span>     */</span><span class="WHIT">
<span class='line'>1254</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.setPreferredOrientation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">preferredOrientation</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1255</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1256</span> </span><span class="WHIT">            </span><span class="NAME">window.ext.IDTK_APP.makeCall</span><span class="PUNC">(</span><span class="STRN">"setPreferredOrientation"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">preferredOrientation</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1257</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1258</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1259</span> 
<span class='line'>1260</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1261</span>     * Queries if a file exists in the specified path and storage type. If none or unknown storage type is specified, the TEMPORARY_STORAGE is used as default.
<span class='line'>1262</span>     * @param {string} path The relative path to look for inside the storage of the underlying system.
<span class='line'>1263</span>     * @param {CocoonJS.App.StorageType} storageType The storage type where to look for the specified path inside the system.
<span class='line'>1264</span>     */</span><span class="WHIT">
<span class='line'>1265</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.existsPath</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">storageType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1266</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">CocoonJS.App.nativeExtensionObjectAvailable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1267</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.ext.IDTK_APP.makeCall</span><span class="PUNC">(</span><span class="STRN">"existsPath"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">path</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">storageType</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1268</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1269</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1270</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1271</span> 
<span class='line'>1272</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1273</span>      * This {@link CocoonJS.EventHandler} object allows listening to events called when the text dialog is finished by accepting it's content.
<span class='line'>1274</span>      * The callback function's documentation is represented by {@link CocoonJS.App.OnTextDialogFinishedListener}
<span class='line'>1275</span>      * @event
<span class='line'>1276</span>      * @static
<span class='line'>1277</span>      * @memberOf CocoonJS.App
<span class='line'>1278</span>      */</span><span class="WHIT">
<span class='line'>1279</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.onTextDialogFinished</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">CocoonJS.EventHandler</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"App"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"ontextdialogfinish"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1280</span> 
<span class='line'>1281</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1282</span>      * This {@link CocoonJS.EventHandler} object allows listening to events called when the text dialog is finished by dismissing it's content.
<span class='line'>1283</span>      * The callback function does not receive any parameter.
<span class='line'>1284</span>      * @event
<span class='line'>1285</span>      * @static
<span class='line'>1286</span>      * @memberOf CocoonJS.App
<span class='line'>1287</span>      */</span><span class="WHIT">
<span class='line'>1288</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.onTextDialogCancelled</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">CocoonJS.EventHandler</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"App"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"ontextdialogcancel"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1289</span> 
<span class='line'>1290</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1291</span>      * This {@link CocoonJS.EventHandler} object allows listening to events called when the text dialog is finished by accepting it's content.
<span class='line'>1292</span>      * The callback function does not receive any parameter.
<span class='line'>1293</span>      * @event
<span class='line'>1294</span>      * @static
<span class='line'>1295</span>      * @memberOf CocoonJS.App
<span class='line'>1296</span>      */</span><span class="WHIT">
<span class='line'>1297</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.onMessageBoxConfirmed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">CocoonJS.EventHandler</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"App"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"onmessageboxconfirmed"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1298</span> 
<span class='line'>1299</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1300</span>      * This {@link CocoonJS.EventHandler} object allows listening to events called when the text dialog is finished by dismissing it's content.
<span class='line'>1301</span>      * The callback function does not receive any parameter.
<span class='line'>1302</span>      * @event
<span class='line'>1303</span>      * @static
<span class='line'>1304</span>      * @memberOf CocoonJS.App
<span class='line'>1305</span>      */</span><span class="WHIT">
<span class='line'>1306</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.onMessageBoxDenied</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">CocoonJS.EventHandler</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"App"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"onmessageboxdenied"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1307</span> 
<span class='line'>1308</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1309</span>      * This {@link CocoonJS.EventHandler} object allows listening to events called when the application is suspended.
<span class='line'>1310</span>      * The callback function does not receive any parameter.
<span class='line'>1311</span>      * @event
<span class='line'>1312</span>      * @static
<span class='line'>1313</span>      * @memberOf CocoonJS.App
<span class='line'>1314</span>      */</span><span class="WHIT">
<span class='line'>1315</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.onSuspended</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">CocoonJS.EventHandler</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"App"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"onsuspended"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1316</span> 
<span class='line'>1317</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1318</span>      * This {@link CocoonJS.EventHandler} object allows listening to events called when the application is suspending.
<span class='line'>1319</span>      * The callback function does not receive any parameter.
<span class='line'>1320</span>      * @event
<span class='line'>1321</span>      * @static
<span class='line'>1322</span>      * @memberOf CocoonJS.App
<span class='line'>1323</span>      */</span><span class="WHIT">
<span class='line'>1324</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.onSuspending</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">CocoonJS.EventHandler</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"App"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"onsuspending"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1325</span> 
<span class='line'>1326</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1327</span>      * This {@link CocoonJS.EventHandler} object allows listening to events called when the application is activated.
<span class='line'>1328</span>      * The callback function does not receive any parameter.
<span class='line'>1329</span>      * @event
<span class='line'>1330</span>      * @static
<span class='line'>1331</span>      * @memberOf CocoonJS.App
<span class='line'>1332</span>      */</span><span class="WHIT">
<span class='line'>1333</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.onActivated</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">CocoonJS.EventHandler</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"App"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"onactivated"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1334</span> 
<span class='line'>1335</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1336</span>      * This {@link CocoonJS.EventHandler} object allows listening to events called when headphones are plugged-in the device.
<span class='line'>1337</span>      * The callback function does not receive any parameter.
<span class='line'>1338</span>      * @event
<span class='line'>1339</span>      * @static
<span class='line'>1340</span>      * @memberOf CocoonJS.App
<span class='line'>1341</span>      */</span><span class="WHIT">
<span class='line'>1342</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.onHeadphonesPluggedIn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">CocoonJS.EventHandler</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"App"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"onheadphonespluggedin"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1343</span> 
<span class='line'>1344</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1345</span>      * This {@link CocoonJS.EventHandler} object allows listening to events called when headphones are unplugged from the device.
<span class='line'>1346</span>      * The callback function does not receive any parameter.
<span class='line'>1347</span>      * @event
<span class='line'>1348</span>      * @static
<span class='line'>1349</span>      * @memberOf CocoonJS.App
<span class='line'>1350</span>      */</span><span class="WHIT">
<span class='line'>1351</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.onHeadphonesUnplugged</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">CocoonJS.EventHandler</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"App"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"onheadphonesunplugged"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1352</span> 
<span class='line'>1353</span> 
<span class='line'>1354</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>1355</span>      * This {@link CocoonJS.EventHandler} object allows listening to events called when the application receives a memory warning notification.
<span class='line'>1356</span>      * The callback function does not receive any parameter.
<span class='line'>1357</span>      * @event
<span class='line'>1358</span>      * @static
<span class='line'>1359</span>      * @memberOf CocoonJS.App
<span class='line'>1360</span>      */</span><span class="WHIT">
<span class='line'>1361</span> </span><span class="WHIT">    </span><span class="NAME">CocoonJS.App.onMemoryWarning</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">CocoonJS.EventHandler</span><span class="PUNC">(</span><span class="STRN">"IDTK_APP"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"App"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"onmemorywarning"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1362</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1363</span> </span></pre></body></html>